{% extends 'base.html' %}

{% block title %}Logged Out - ShopHub{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 text-center">
            <div class="card border-0 shadow-lg">
                <div class="card-body p-5">
                    <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                    <h2 class="fw-bold mt-3 mb-3">Successfully Logged Out</h2>
                    <p class="text-muted mb-4">Thank you for visiting ShopHub. Come back soon!</p>
                    
                    <div class="d-grid gap-2">
                        <a href="{% url 'store:home' %}" class="btn btn-primary btn-lg">
                            <i class="bi bi-house"></i> Go to Home
                        </a>
                        <a href="{% url 'accounts:login' %}" class="btn btn-outline-secondary">
                            <i class="bi bi-box-arrow-in-right"></i> Login Again
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
"""


# ============================================
# 7. Enhanced Logout with Session Cleanup
# ============================================

from django.contrib.auth import logout
from django.shortcuts import redirect
from django.contrib import messages
from cart.cart import Cart


@login_required
def enhanced_logout(request):
    """
    Enhanced logout that also clears the shopping cart
    Use this if you want to clear cart on logout
    """
    username = request.user.username
    
    # Optional: Clear the cart
    # cart = Cart(request)
    # cart.clear()
    
    # Logout user
    logout(request)
    
    # Clear all session data (optional)
    # request.session.flush()
    
    messages.success(
        request, 
        f'Goodbye {username}! Your session has been ended securely.'
    )
    return redirect('store:home')